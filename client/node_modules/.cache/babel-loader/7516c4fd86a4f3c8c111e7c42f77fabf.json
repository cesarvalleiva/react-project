{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactDom = require('react-dom');\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _interactjs = require('interactjs');\n\nvar _interactjs2 = _interopRequireDefault(_interactjs);\n\nvar _clone = require('lodash/clone');\n\nvar _clone2 = _interopRequireDefault(_clone);\n\nvar _isFunction = require('lodash/isFunction');\n\nvar _isFunction2 = _interopRequireDefault(_isFunction);\n\nvar _sortBy = require('lodash/sortBy');\n\nvar _sortBy2 = _interopRequireDefault(_sortBy);\n\nvar _get = require('lodash/get');\n\nvar _get2 = _interopRequireDefault(_get);\n\nvar _uniqueId = require('lodash/uniqueId');\n\nvar _uniqueId2 = _interopRequireDefault(_uniqueId);\n\nvar _bind = require('lodash/bind');\n\nvar _bind2 = _interopRequireDefault(_bind);\n\nvar _union = require('lodash/union');\n\nvar _union2 = _interopRequireDefault(_union);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n} // Tools\n\n\nvar findDOMNode = _reactDom2.default.findDOMNode;\n\nvar getStyle = function getStyle(e, styleName) {\n  var styleValue = '';\n\n  if (document.defaultView && document.defaultView.getComputedStyle) {\n    styleValue = document.defaultView.getComputedStyle(e, '').getPropertyValue(styleName);\n  } else if (e.currentStyle) {\n    styleName = styleName.replace(/\\-(\\w)/g, function (strMatch, p1) {\n      return p1.toUpperCase();\n    });\n    styleValue = e.currentStyle[styleName];\n  }\n\n  return styleValue;\n};\n\nvar _positions = {};\n\nvar DragSortableList = function (_React$Component) {\n  _inherits(DragSortableList, _React$Component);\n\n  function DragSortableList(props) {\n    _classCallCheck(this, DragSortableList);\n\n    var _this = _possibleConstructorReturn(this, (DragSortableList.__proto__ || Object.getPrototypeOf(DragSortableList)).call(this, props));\n\n    _this.state = {\n      placeholder: null,\n      // target item (being dragged over)\n      dragging: null,\n      // dragged item (being dragged),\n      items: []\n    };\n    _this.ref = 'List' + (0, _uniqueId2.default)(); // generate unique ref\n\n    return _this;\n  }\n\n  _createClass(DragSortableList, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      var draggableChildrenSelector = '#' + this.ref + '> .draggable';\n\n      var ignoreNoDrag = function ignoreNoDrag(fun) {\n        return function (event) {\n          var mouseElement = document.elementFromPoint(event.clientX, event.clientY);\n\n          if (mouseElement && !mouseElement.classList.contains('no-drag') && mouseElement.parentNode && !mouseElement.parentNode.classList.contains('no-drag')) {\n            fun(event);\n          } else {\n            _interactjs2.default.stop(event);\n          }\n        };\n      };\n\n      (0, _interactjs2.default)(draggableChildrenSelector).draggable({\n        onmove: ignoreNoDrag(this._dragMove.bind(this)),\n        onend: ignoreNoDrag(this._dragEnd.bind(this))\n      }).styleCursor(false);\n\n      this._initItems(this.props);\n    }\n  }, {\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(newProps) {\n      this._initItems(newProps);\n    }\n  }, {\n    key: 'componentWillUpdate',\n    value: function componentWillUpdate(nextProps, nextState) {\n      var _this2 = this; // Store positions for animation\n\n\n      var moveTransitionDuration = this.props.moveTransitionDuration;\n      var items = this.state.items;\n\n      if (moveTransitionDuration) {\n        var itemsRefs = (0, _union2.default)(['placeholder'], items.map(function (item) {\n          return 'item-' + item.id;\n        }));\n        itemsRefs.forEach(function (itemRef) {\n          var el = _this2.refs[_this2.ref + itemRef];\n\n          if (el) {\n            _positions[itemRef] = {\n              left: el.offsetLeft,\n              top: el.offsetTop\n            };\n          }\n        });\n      }\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(prevProps, prevState) {\n      var _this3 = this;\n\n      var moveTransitionDuration = this.props.moveTransitionDuration;\n      var items = this.state.items;\n\n      if (moveTransitionDuration) {\n        var placeholderEl = this.refs[this.ref + \"placeholder\"];\n\n        if (placeholderEl && (0, _get2.default)(prevState, 'placeholder.rank') && (0, _get2.default)(prevState, 'placeholder.rank') !== (0, _get2.default)(this.state, 'placeholder.rank')) {\n          (function () {\n            var itemsRefs = (0, _union2.default)(['placeholder'], items.map(function (item) {\n              return 'item-' + item.id;\n            }));\n            var instructions = {\n              transitions: [],\n              transforms: []\n            };\n            itemsRefs.forEach(function (itemRef) {\n              var el = _this3.refs[_this3.ref + itemRef];\n\n              if (el) {\n                var x = _positions[itemRef].left - el.offsetLeft;\n                var y = _positions[itemRef].top - el.offsetTop;\n                el.style.webkitTransform = el.style.transform = el.style.msTransform = 'translate(' + x + 'px, ' + y + 'px)'; // move back to former position\n\n                instructions.transitions.push(function () {\n                  el.style.WebkitTransition = el.style.transition = 'transform ' + moveTransitionDuration + 's';\n                });\n                instructions.transforms.push(function () {\n                  el.style.webkitTransform = el.style.transform = null;\n                });\n              }\n            }); // Add all transitions and remove transforms\n\n            window.setTimeout(function () {\n              instructions.transitions.forEach(function (instruction) {\n                instruction();\n              });\n              instructions.transforms.forEach(function (instruction) {\n                instruction();\n              });\n            }, 100); // give it some time to make sure transform has been applied\n          })();\n        }\n      }\n    }\n  }, {\n    key: '_initItems',\n    value: function _initItems(props) {\n      var items = props.items;\n      var newItems = items.map(function (item, i) {\n        item.rank = i;\n        item.id = item.id ? item.id : (0, _uniqueId2.default)();\n        return item;\n      });\n      this.setState({\n        items: newItems\n      });\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this4 = this;\n\n      var _state = this.state,\n          placeholder = _state.placeholder,\n          dragging = _state.dragging,\n          items = _state.items;\n      var listItems = (0, _clone2.default)(items, true);\n      var draggedItem = null; // Add drag target\n\n      if (placeholder) {\n        // Save dragged item\n        listItems.forEach(function (item) {\n          if (dragging && item.id === dragging.id) {\n            draggedItem = item; // store it for display\n          }\n        }); // Add placeholder\n\n        listItems.push({\n          rank: placeholder.rank,\n          placeholder: draggedItem\n        }); // Sort list\n\n        listItems = (0, _sortBy2.default)(listItems, function (item) {\n          return item.rank;\n        });\n      }\n\n      var itemsNodes = listItems.map(function (item) {\n        if (item.placeholder) {\n          return _this4._displayItem(item.placeholder, 'placeholder');\n        } else {\n          var type = draggedItem === item ? 'dragged' : 'normal';\n          return _this4._displayItem(item, type);\n        }\n      });\n      return _react2.default.createElement('div', {\n        id: this.ref,\n        className: 'List',\n        ref: this.ref\n      }, itemsNodes);\n    }\n  }, {\n    key: '_displayItem',\n    value: function _displayItem(item, type) {\n      var layoutType = this.props.type;\n      var id = item.id,\n          content = item.content,\n          classes = item.classes,\n          rank = item.rank;\n      var dragging = this.state.dragging;\n      var placeholder = this.props.placeholder || content;\n      var key = 'item-' + id;\n      var style = {\n        position: 'relative',\n        float: layoutType === 'horizontal' || layoutType === 'grid' ? 'left' : 'none'\n      };\n      var classNames = 'draggable';\n      classNames += classes ? ' ' + classes.join(' ') : '';\n\n      if (type === 'normal') {\n        return _react2.default.createElement('div', {\n          ref: this.ref + key,\n          style: style,\n          'data-id': id,\n          'data-rank': rank,\n          key: key,\n          className: classNames\n        }, content);\n      }\n\n      if (type === 'dragged') {\n        style['display'] = 'none'; // to avoid flicker effect when translate happens\n\n        style['zIndex'] = 10; // make sur it is on top\n\n        classNames += ' dragged';\n        return _react2.default.createElement('div', {\n          ref: this.ref + 'dragged',\n          'data-id': id,\n          key: key,\n          className: classNames,\n          style: style\n        }, content);\n      }\n\n      if (type === 'placeholder') {\n        style.width = dragging.width; // set with and height\n\n        style.height = dragging.height;\n        classNames += ' placeholder';\n        return _react2.default.createElement('div', {\n          ref: this.ref + 'placeholder',\n          key: 'placeholder',\n          className: classNames,\n          style: style\n        }, placeholder);\n      }\n    }\n  }, {\n    key: '_dragMove',\n    value: function _dragMove(event) {\n      var _this5 = this;\n\n      var target = event.target;\n      var dragging = this.state.dragging; // Move copy of dragged element and keep the dragged position in the data-x/data-y attributes\n\n      var x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx;\n      var y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy;\n      target.setAttribute('data-x', x);\n      target.setAttribute('data-y', y); // prepare future state\n\n      var state = (0, _clone2.default)(this.state, true);\n      var dragId = target.getAttribute('data-id');\n      state.dragging = state.dragging ? state.dragging : {\n        id: dragId\n      };\n      var draggedEl = this.refs[this.ref + 'dragged']; // If dragging has already been started\n\n      if (draggedEl && state.dragging) {\n        // Translate dragged item\n        draggedEl.style.display = 'block';\n        draggedEl.style.position = 'absolute';\n        draggedEl.style.top = state.dragging.top + 'px';\n        draggedEl.style.left = state.dragging.left + 'px';\n        draggedEl.style.WebkitTransition = draggedEl.style.transition = 'none'; // no transition\n\n        draggedEl.style.webkitTransform = draggedEl.style.transform = draggedEl.style.msTransform = 'translate(' + x + 'px, ' + y + 'px)';\n      } else {\n        // Dragging has just started, store original position\n        state.dragging.top = target.offsetTop - parseInt(getStyle(target, 'margin-top'), 10);\n        state.dragging.left = target.offsetLeft - parseInt(getStyle(target, 'margin-left'), 10);\n        state.dragging.width = target.offsetWidth;\n        state.dragging.height = target.offsetHeight;\n      } // Update state if necessary and move placeholder\n\n\n      if (!dragging) {\n        this.setState(state, function () {\n          _this5._movePlaceholder(event);\n        });\n      } else {\n        this._movePlaceholder(event);\n      }\n    }\n  }, {\n    key: '_dragEnd',\n    value: function _dragEnd(event) {\n      var _props = this.props,\n          onSort = _props.onSort,\n          dropBackTransitionDuration = _props.dropBackTransitionDuration;\n      var _state2 = this.state,\n          dragging = _state2.dragging,\n          stateItems = _state2.items;\n\n      var items = this._moveItem();\n\n      var draggedEl = this.refs[this.ref + 'dragged'];\n      if (!draggedEl) return; // Add transition if rank hasn't changed\n\n      var draggedBefore = stateItems.find(function (item) {\n        return item.id === dragging.id;\n      });\n      var draggedAfter = items.find(function (item) {\n        return item.id === dragging.id;\n      });\n\n      if (draggedBefore && draggedAfter && draggedBefore.rank === draggedAfter.rank && dropBackTransitionDuration) {\n        draggedEl.style.WebkitTransition = draggedEl.style.transition = 'all ' + dropBackTransitionDuration + 's'; // no transition\n      } // Reset style\n\n\n      draggedEl.style.display = null;\n      draggedEl.style.position = 'static';\n      draggedEl.style.top = null;\n      draggedEl.style.left = null;\n      draggedEl.style.webkitTransform = draggedEl.style.transform = draggedEl.style.msTransform = 'none';\n      draggedEl.setAttribute('data-x', 0);\n      draggedEl.setAttribute('data-y', 0); // Update rank\n\n      this.setState({\n        dragging: null,\n        placeholder: null,\n        items: items\n      });\n\n      if (onSort && (0, _isFunction2.default)(onSort)) {\n        onSort(items, event);\n      }\n    }\n  }, {\n    key: '_moveItem',\n    value: function _moveItem() {\n      var _state3 = this.state,\n          stateItems = _state3.items,\n          placeholder = _state3.placeholder,\n          dragging = _state3.dragging;\n      var items = (0, _clone2.default)(stateItems, true); // Replace dragged item rank\n\n      var dragged = items.find(function (item) {\n        return item.id === dragging.id;\n      });\n      if (dragged && placeholder) dragged.rank = placeholder.rank;\n      items = (0, _sortBy2.default)(items, function (item) {\n        return item.rank;\n      }); // Normalize items ranks\n\n      var rank = 0;\n      items.forEach(function (item) {\n        item.rank = rank;\n        rank++;\n      });\n      return items;\n    }\n  }, {\n    key: '_movePlaceholder',\n    value: function _movePlaceholder(e) {\n      var _this6 = this;\n\n      var placeholder = this.state.placeholder;\n      var list = this.refs[this.ref];\n      var mouseX = e.pageX,\n          mouseY = e.pageY;\n      var childNodes = [].slice.call(list.childNodes);\n      var children = childNodes.filter(function (child) {\n        return !!child.getAttribute('data-rank');\n      }); // Find placeholder\n\n      var newPlaceholder = void 0;\n      children.forEach(function (child) {\n        newPlaceholder = _this6._calculatePlaceholder(child, mouseX, mouseY, newPlaceholder);\n      }); // Update state if necessary\n\n      if (newPlaceholder && (!placeholder || newPlaceholder.rank !== placeholder.rank)) {\n        this.setState({\n          placeholder: newPlaceholder\n        });\n      }\n    }\n  }, {\n    key: '_calculatePlaceholder',\n    value: function _calculatePlaceholder(child, mouseX, mouseY, placeholder) {\n      var type = this.props.type;\n      var scrollY = window.scrollY || window.pageYOffset || document.documentElement.scrollTop;\n      mouseY = mouseY - scrollY; // make up for bounding rect not considering scrollY\n\n      var _child$getBoundingCli = child.getBoundingClientRect(),\n          top = _child$getBoundingCli.top,\n          left = _child$getBoundingCli.left;\n\n      var offsetHeight = child.offsetHeight,\n          offsetWidth = child.offsetWidth;\n      var childX = left + offsetWidth / 2;\n      var childY = top + offsetHeight / 2;\n      var distanceX = mouseX - childX;\n      var distanceY = mouseY - childY;\n      var difference = void 0;\n      var distance = void 0;\n      var rank = void 0;\n\n      if (type === 'grid') {\n        // Skip if not on the same line\n        if (mouseY < top || mouseY > top + offsetHeight) {\n          return placeholder;\n        }\n\n        distance = Math.abs(distanceX);\n        difference = distanceX;\n      } else {\n        distance = type === 'vertical' ? Math.abs(distanceY) : Math.abs(distanceX);\n        difference = type === 'vertical' ? distanceY : distanceX;\n      }\n\n      if (!placeholder || distance < placeholder.distance) {\n        var pos = difference > 0 ? 'after' : 'before';\n\n        var _rank = parseInt(child.getAttribute('data-rank'), 10);\n\n        _rank += pos === 'before' ? -0.5 : 0.5;\n        placeholder = {\n          rank: _rank,\n          distance: distance\n        };\n      }\n\n      return placeholder;\n    }\n  }]);\n\n  return DragSortableList;\n}(_react2.default.Component); // Props\n\n\nDragSortableList.propTypes = {\n  items: _propTypes2.default.array,\n  type: _propTypes2.default.string,\n  dropBackTransitionDuration: _propTypes2.default.number,\n  moveTransitionDuration: _propTypes2.default.number\n};\nDragSortableList.defaultProps = {\n  items: [],\n  type: 'vertical',\n  //horizontal\n  dropBackTransitionDuration: null\n};\nexports.default = DragSortableList;","map":{"version":3,"sources":["/Users/cesarvalleiva/Desktop/proyectos/web/client/node_modules/react-drag-sortable/lib/index.js"],"names":["Object","defineProperty","exports","value","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","Constructor","protoProps","staticProps","prototype","_react","require","_react2","_interopRequireDefault","_reactDom","_reactDom2","_interactjs","_interactjs2","_clone","_clone2","_isFunction","_isFunction2","_sortBy","_sortBy2","_get","_get2","_uniqueId","_uniqueId2","_bind","_bind2","_union","_union2","_propTypes","_propTypes2","obj","__esModule","default","_classCallCheck","instance","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","findDOMNode","getStyle","e","styleName","styleValue","document","defaultView","getComputedStyle","getPropertyValue","currentStyle","replace","strMatch","p1","toUpperCase","_positions","DragSortableList","_React$Component","_this","getPrototypeOf","state","placeholder","dragging","items","ref","componentDidMount","draggableChildrenSelector","ignoreNoDrag","fun","event","mouseElement","elementFromPoint","clientX","clientY","classList","contains","parentNode","stop","draggable","onmove","_dragMove","bind","onend","_dragEnd","styleCursor","_initItems","componentWillReceiveProps","newProps","componentWillUpdate","nextProps","nextState","_this2","moveTransitionDuration","itemsRefs","map","item","id","forEach","itemRef","el","refs","left","offsetLeft","top","offsetTop","componentDidUpdate","prevProps","prevState","_this3","placeholderEl","instructions","transitions","transforms","x","y","style","webkitTransform","transform","msTransform","push","WebkitTransition","transition","window","setTimeout","instruction","newItems","rank","setState","render","_this4","_state","listItems","draggedItem","itemsNodes","_displayItem","type","createElement","className","layoutType","content","classes","position","float","classNames","join","width","height","_this5","parseFloat","getAttribute","dx","dy","setAttribute","dragId","draggedEl","display","parseInt","offsetWidth","offsetHeight","_movePlaceholder","_props","onSort","dropBackTransitionDuration","_state2","stateItems","_moveItem","draggedBefore","find","draggedAfter","_state3","dragged","_this6","list","mouseX","pageX","mouseY","pageY","childNodes","slice","children","filter","child","newPlaceholder","_calculatePlaceholder","scrollY","pageYOffset","documentElement","scrollTop","_child$getBoundingCli","getBoundingClientRect","childX","childY","distanceX","distanceY","difference","distance","Math","abs","pos","_rank","Component","propTypes","array","string","number","defaultProps"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactDom = require('react-dom');\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _interactjs = require('interactjs');\n\nvar _interactjs2 = _interopRequireDefault(_interactjs);\n\nvar _clone = require('lodash/clone');\n\nvar _clone2 = _interopRequireDefault(_clone);\n\nvar _isFunction = require('lodash/isFunction');\n\nvar _isFunction2 = _interopRequireDefault(_isFunction);\n\nvar _sortBy = require('lodash/sortBy');\n\nvar _sortBy2 = _interopRequireDefault(_sortBy);\n\nvar _get = require('lodash/get');\n\nvar _get2 = _interopRequireDefault(_get);\n\nvar _uniqueId = require('lodash/uniqueId');\n\nvar _uniqueId2 = _interopRequireDefault(_uniqueId);\n\nvar _bind = require('lodash/bind');\n\nvar _bind2 = _interopRequireDefault(_bind);\n\nvar _union = require('lodash/union');\n\nvar _union2 = _interopRequireDefault(_union);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } // Tools\n\n\nvar findDOMNode = _reactDom2.default.findDOMNode;\n\nvar getStyle = function getStyle(e, styleName) {\n  var styleValue = '';\n  if (document.defaultView && document.defaultView.getComputedStyle) {\n    styleValue = document.defaultView.getComputedStyle(e, '').getPropertyValue(styleName);\n  } else if (e.currentStyle) {\n    styleName = styleName.replace(/\\-(\\w)/g, function (strMatch, p1) {\n      return p1.toUpperCase();\n    });\n    styleValue = e.currentStyle[styleName];\n  }\n  return styleValue;\n};\n\nvar _positions = {};\n\nvar DragSortableList = function (_React$Component) {\n  _inherits(DragSortableList, _React$Component);\n\n  function DragSortableList(props) {\n    _classCallCheck(this, DragSortableList);\n\n    var _this = _possibleConstructorReturn(this, (DragSortableList.__proto__ || Object.getPrototypeOf(DragSortableList)).call(this, props));\n\n    _this.state = {\n      placeholder: null, // target item (being dragged over)\n      dragging: null, // dragged item (being dragged),\n      items: []\n    };\n    _this.ref = 'List' + (0, _uniqueId2.default)(); // generate unique ref\n    return _this;\n  }\n\n  _createClass(DragSortableList, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      var draggableChildrenSelector = '#' + this.ref + '> .draggable';\n      var ignoreNoDrag = function ignoreNoDrag(fun) {\n        return function (event) {\n          var mouseElement = document.elementFromPoint(event.clientX, event.clientY);\n          if (mouseElement && !mouseElement.classList.contains('no-drag') && mouseElement.parentNode && !mouseElement.parentNode.classList.contains('no-drag')) {\n            fun(event);\n          } else {\n            _interactjs2.default.stop(event);\n          }\n        };\n      };\n      (0, _interactjs2.default)(draggableChildrenSelector).draggable({\n        onmove: ignoreNoDrag(this._dragMove.bind(this)),\n        onend: ignoreNoDrag(this._dragEnd.bind(this))\n      }).styleCursor(false);\n      this._initItems(this.props);\n    }\n  }, {\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(newProps) {\n      this._initItems(newProps);\n    }\n  }, {\n    key: 'componentWillUpdate',\n    value: function componentWillUpdate(nextProps, nextState) {\n      var _this2 = this;\n\n      // Store positions for animation\n      var moveTransitionDuration = this.props.moveTransitionDuration;\n      var items = this.state.items;\n\n      if (moveTransitionDuration) {\n        var itemsRefs = (0, _union2.default)(['placeholder'], items.map(function (item) {\n          return 'item-' + item.id;\n        }));\n        itemsRefs.forEach(function (itemRef) {\n          var el = _this2.refs[_this2.ref + itemRef];\n          if (el) {\n            _positions[itemRef] = {\n              left: el.offsetLeft,\n              top: el.offsetTop\n            };\n          }\n        });\n      }\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(prevProps, prevState) {\n      var _this3 = this;\n\n      var moveTransitionDuration = this.props.moveTransitionDuration;\n      var items = this.state.items;\n\n\n      if (moveTransitionDuration) {\n        var placeholderEl = this.refs[this.ref + \"placeholder\"];\n        if (placeholderEl && (0, _get2.default)(prevState, 'placeholder.rank') && (0, _get2.default)(prevState, 'placeholder.rank') !== (0, _get2.default)(this.state, 'placeholder.rank')) {\n          (function () {\n            var itemsRefs = (0, _union2.default)(['placeholder'], items.map(function (item) {\n              return 'item-' + item.id;\n            }));\n            var instructions = {\n              transitions: [],\n              transforms: []\n            };\n            itemsRefs.forEach(function (itemRef) {\n              var el = _this3.refs[_this3.ref + itemRef];\n              if (el) {\n                var x = _positions[itemRef].left - el.offsetLeft;\n                var y = _positions[itemRef].top - el.offsetTop;\n                el.style.webkitTransform = el.style.transform = el.style.msTransform = 'translate(' + x + 'px, ' + y + 'px)'; // move back to former position\n                instructions.transitions.push(function () {\n                  el.style.WebkitTransition = el.style.transition = 'transform ' + moveTransitionDuration + 's';\n                });\n                instructions.transforms.push(function () {\n                  el.style.webkitTransform = el.style.transform = null;\n                });\n              }\n            });\n\n            // Add all transitions and remove transforms\n            window.setTimeout(function () {\n              instructions.transitions.forEach(function (instruction) {\n                instruction();\n              });\n              instructions.transforms.forEach(function (instruction) {\n                instruction();\n              });\n            }, 100); // give it some time to make sure transform has been applied\n          })();\n        }\n      }\n    }\n  }, {\n    key: '_initItems',\n    value: function _initItems(props) {\n      var items = props.items;\n\n      var newItems = items.map(function (item, i) {\n        item.rank = i;\n        item.id = item.id ? item.id : (0, _uniqueId2.default)();\n        return item;\n      });\n      this.setState({\n        items: newItems\n      });\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this4 = this;\n\n      var _state = this.state,\n          placeholder = _state.placeholder,\n          dragging = _state.dragging,\n          items = _state.items;\n\n      var listItems = (0, _clone2.default)(items, true);\n      var draggedItem = null;\n\n      // Add drag target\n      if (placeholder) {\n        // Save dragged item\n        listItems.forEach(function (item) {\n          if (dragging && item.id === dragging.id) {\n            draggedItem = item; // store it for display\n          }\n        });\n\n        // Add placeholder\n        listItems.push({\n          rank: placeholder.rank,\n          placeholder: draggedItem\n        });\n\n        // Sort list\n        listItems = (0, _sortBy2.default)(listItems, function (item) {\n          return item.rank;\n        });\n      }\n\n      var itemsNodes = listItems.map(function (item) {\n        if (item.placeholder) {\n          return _this4._displayItem(item.placeholder, 'placeholder');\n        } else {\n          var type = draggedItem === item ? 'dragged' : 'normal';\n          return _this4._displayItem(item, type);\n        }\n      });\n\n      return _react2.default.createElement(\n        'div',\n        { id: this.ref, className: 'List', ref: this.ref },\n        itemsNodes\n      );\n    }\n  }, {\n    key: '_displayItem',\n    value: function _displayItem(item, type) {\n      var layoutType = this.props.type;\n      var id = item.id,\n          content = item.content,\n          classes = item.classes,\n          rank = item.rank;\n      var dragging = this.state.dragging;\n\n      var placeholder = this.props.placeholder || content;\n      var key = 'item-' + id;\n      var style = {\n        position: 'relative',\n        float: layoutType === 'horizontal' || layoutType === 'grid' ? 'left' : 'none'\n      };\n      var classNames = 'draggable';\n      classNames += classes ? ' ' + classes.join(' ') : '';\n\n      if (type === 'normal') {\n        return _react2.default.createElement(\n          'div',\n          { ref: this.ref + key, style: style, 'data-id': id, 'data-rank': rank, key: key, className: classNames },\n          content\n        );\n      }\n\n      if (type === 'dragged') {\n        style['display'] = 'none'; // to avoid flicker effect when translate happens\n        style['zIndex'] = 10; // make sur it is on top\n        classNames += ' dragged';\n        return _react2.default.createElement(\n          'div',\n          { ref: this.ref + 'dragged', 'data-id': id, key: key, className: classNames, style: style },\n          content\n        );\n      }\n\n      if (type === 'placeholder') {\n        style.width = dragging.width; // set with and height\n        style.height = dragging.height;\n        classNames += ' placeholder';\n        return _react2.default.createElement(\n          'div',\n          { ref: this.ref + 'placeholder', key: 'placeholder', className: classNames, style: style },\n          placeholder\n        );\n      }\n    }\n  }, {\n    key: '_dragMove',\n    value: function _dragMove(event) {\n      var _this5 = this;\n\n      var target = event.target;\n      var dragging = this.state.dragging;\n\n      // Move copy of dragged element and keep the dragged position in the data-x/data-y attributes\n\n      var x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx;\n      var y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy;\n      target.setAttribute('data-x', x);\n      target.setAttribute('data-y', y);\n\n      // prepare future state\n      var state = (0, _clone2.default)(this.state, true);\n      var dragId = target.getAttribute('data-id');\n      state.dragging = state.dragging ? state.dragging : { id: dragId };\n      var draggedEl = this.refs[this.ref + 'dragged'];\n\n      // If dragging has already been started\n      if (draggedEl && state.dragging) {\n        // Translate dragged item\n        draggedEl.style.display = 'block';\n        draggedEl.style.position = 'absolute';\n        draggedEl.style.top = state.dragging.top + 'px';\n        draggedEl.style.left = state.dragging.left + 'px';\n        draggedEl.style.WebkitTransition = draggedEl.style.transition = 'none'; // no transition\n        draggedEl.style.webkitTransform = draggedEl.style.transform = draggedEl.style.msTransform = 'translate(' + x + 'px, ' + y + 'px)';\n      } else {\n        // Dragging has just started, store original position\n        state.dragging.top = target.offsetTop - parseInt(getStyle(target, 'margin-top'), 10);\n        state.dragging.left = target.offsetLeft - parseInt(getStyle(target, 'margin-left'), 10);\n        state.dragging.width = target.offsetWidth;\n        state.dragging.height = target.offsetHeight;\n      }\n\n      // Update state if necessary and move placeholder\n      if (!dragging) {\n        this.setState(state, function () {\n          _this5._movePlaceholder(event);\n        });\n      } else {\n        this._movePlaceholder(event);\n      }\n    }\n  }, {\n    key: '_dragEnd',\n    value: function _dragEnd(event) {\n      var _props = this.props,\n          onSort = _props.onSort,\n          dropBackTransitionDuration = _props.dropBackTransitionDuration;\n      var _state2 = this.state,\n          dragging = _state2.dragging,\n          stateItems = _state2.items;\n\n      var items = this._moveItem();\n      var draggedEl = this.refs[this.ref + 'dragged'];\n\n      if (!draggedEl) return;\n\n      // Add transition if rank hasn't changed\n      var draggedBefore = stateItems.find(function (item) {\n        return item.id === dragging.id;\n      });\n      var draggedAfter = items.find(function (item) {\n        return item.id === dragging.id;\n      });\n\n      if (draggedBefore && draggedAfter && draggedBefore.rank === draggedAfter.rank && dropBackTransitionDuration) {\n        draggedEl.style.WebkitTransition = draggedEl.style.transition = 'all ' + dropBackTransitionDuration + 's'; // no transition\n      }\n\n      // Reset style\n      draggedEl.style.display = null;\n      draggedEl.style.position = 'static';\n      draggedEl.style.top = null;\n      draggedEl.style.left = null;\n      draggedEl.style.webkitTransform = draggedEl.style.transform = draggedEl.style.msTransform = 'none';\n      draggedEl.setAttribute('data-x', 0);\n      draggedEl.setAttribute('data-y', 0);\n\n      // Update rank\n      this.setState({\n        dragging: null,\n        placeholder: null,\n        items: items\n      });\n\n      if (onSort && (0, _isFunction2.default)(onSort)) {\n        onSort(items, event);\n      }\n    }\n  }, {\n    key: '_moveItem',\n    value: function _moveItem() {\n      var _state3 = this.state,\n          stateItems = _state3.items,\n          placeholder = _state3.placeholder,\n          dragging = _state3.dragging;\n\n      var items = (0, _clone2.default)(stateItems, true);\n\n      // Replace dragged item rank\n      var dragged = items.find(function (item) {\n        return item.id === dragging.id;\n      });\n      if (dragged && placeholder) dragged.rank = placeholder.rank;\n\n      items = (0, _sortBy2.default)(items, function (item) {\n        return item.rank;\n      });\n\n      // Normalize items ranks\n      var rank = 0;\n      items.forEach(function (item) {\n        item.rank = rank;\n        rank++;\n      });\n\n      return items;\n    }\n  }, {\n    key: '_movePlaceholder',\n    value: function _movePlaceholder(e) {\n      var _this6 = this;\n\n      var placeholder = this.state.placeholder;\n\n      var list = this.refs[this.ref];\n      var mouseX = e.pageX,\n          mouseY = e.pageY;\n\n      var childNodes = [].slice.call(list.childNodes);\n      var children = childNodes.filter(function (child) {\n        return !!child.getAttribute('data-rank');\n      });\n\n      // Find placeholder\n      var newPlaceholder = void 0;\n      children.forEach(function (child) {\n        newPlaceholder = _this6._calculatePlaceholder(child, mouseX, mouseY, newPlaceholder);\n      });\n\n      // Update state if necessary\n      if (newPlaceholder && (!placeholder || newPlaceholder.rank !== placeholder.rank)) {\n        this.setState({\n          placeholder: newPlaceholder\n        });\n      }\n    }\n  }, {\n    key: '_calculatePlaceholder',\n    value: function _calculatePlaceholder(child, mouseX, mouseY, placeholder) {\n      var type = this.props.type;\n\n      var scrollY = window.scrollY || window.pageYOffset || document.documentElement.scrollTop;\n      mouseY = mouseY - scrollY; // make up for bounding rect not considering scrollY\n\n      var _child$getBoundingCli = child.getBoundingClientRect(),\n          top = _child$getBoundingCli.top,\n          left = _child$getBoundingCli.left;\n\n      var offsetHeight = child.offsetHeight,\n          offsetWidth = child.offsetWidth;\n\n      var childX = left + offsetWidth / 2;\n      var childY = top + offsetHeight / 2;\n      var distanceX = mouseX - childX;\n      var distanceY = mouseY - childY;\n      var difference = void 0;\n      var distance = void 0;\n      var rank = void 0;\n      if (type === 'grid') {\n        // Skip if not on the same line\n        if (mouseY < top || mouseY > top + offsetHeight) {\n          return placeholder;\n        }\n        distance = Math.abs(distanceX);\n        difference = distanceX;\n      } else {\n        distance = type === 'vertical' ? Math.abs(distanceY) : Math.abs(distanceX);\n        difference = type === 'vertical' ? distanceY : distanceX;\n      }\n\n      if (!placeholder || distance < placeholder.distance) {\n\n        var pos = difference > 0 ? 'after' : 'before';\n        var _rank = parseInt(child.getAttribute('data-rank'), 10);\n        _rank += pos === 'before' ? -0.5 : 0.5;\n\n        placeholder = {\n          rank: _rank,\n          distance: distance\n        };\n      }\n\n      return placeholder;\n    }\n  }]);\n\n  return DragSortableList;\n}(_react2.default.Component);\n\n// Props\n\n\nDragSortableList.propTypes = {\n  items: _propTypes2.default.array,\n  type: _propTypes2.default.string,\n  dropBackTransitionDuration: _propTypes2.default.number,\n  moveTransitionDuration: _propTypes2.default.number\n};\nDragSortableList.defaultProps = {\n  items: [],\n  type: 'vertical', //horizontal\n  dropBackTransitionDuration: null\n};\n\nexports.default = DragSortableList;"]},"metadata":{},"sourceType":"script"}